sudo: false
language: scala
scala:
  - 2.11.12
  - 2.12.6
jdk:
  - oraclejdk8
cache:
  directories:
    - $HOME/.ivy2/cache
script:
  - sbt ++$TRAVIS_SCALA_VERSION ;test;doc
after_success:
  - if [ $TRAVIS_PULL_REQUEST = 'false' ] && [[ $TRAVIS_BRANCH = "master" || $TRAVIS_BRANCH = "release/"* ]]; then
      sbt ++$TRAVIS_SCALA_VERSION releaseEarly;
    fi
  - if [[ $TRAVIS_TAG && $TRAVIS_SCALA_VERSION == 2.12* ]] && [[ $TRAVIS_BRANCH = "master" || $TRAVIS_BRANCH = "release/"* ]]; then
      export GIT_AUTHOR_NAME="Travis CI"
      export GIT_AUTHOR_EMAIL="travis-ci@http4s.org"
      export GIT_COMMITTER_NAME=$GIT_AUTHOR_NAME
      export GIT_COMMITTER_EMAIL=$GIT_AUTHOR_EMAIL
      sbt docs/ghpagesPushSite
    fi
env:
  global:
    - secure: ...
before_install:
  - if [ $TRAVIS_PULL_REQUEST = "false" ] && [[ $TRAVIS_BRANCH = "master" || $TRAVIS_BRANCH = "release/"* ]]; then
    openssl aes-256-cbc -K $encrypted_xxxxx_key -iv $encrypted_xxxxx_iv -in travis/secrets.tar.enc -out travis/secrets.tar -d;
    tar xv -C travis -f travis/secrets.tar;
  fi
